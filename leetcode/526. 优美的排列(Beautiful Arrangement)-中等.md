# 一、题目
假设有从 1 到 N 的 N 个整数，如果从这 N 个数字中成功构造出一个数组，使得数组的第 i 位 (1 <= i <= N) 满足如下两个条件中的一个，我们就称这个数组为一个优美的排列。条件：   
- 第 i 位的数字能被 i 整除
- i 能被第 i 位上的数字整除
    
    
现在给定一个整数 N，请问可以构造多少个优美的排列？   
   
**示例1:**   
```
输入: 2
输出: 2
解释: 

第 1 个优美的排列是 [1, 2]:
  第 1 个位置（i=1）上的数字是1，1能被 i（i=1）整除
  第 2 个位置（i=2）上的数字是2，2能被 i（i=2）整除

第 2 个优美的排列是 [2, 1]:
  第 1 个位置（i=1）上的数字是2，2能被 i（i=1）整除
  第 2 个位置（i=2）上的数字是1，i（i=2）能被 1 整除
```
**说明:**   
- N 是一个正整数，并且不会超过15。
   
   
来源：力扣（LeetCode）   
链接：[https://leetcode-cn.com/problems/beautiful-arrangement](https://leetcode-cn.com/problems/beautiful-arrangement)   
著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。   
# 二、分析及代码    
## 1. 状态压缩 + 动态规划
### （1）思路
因为 N 是一个不超过 15 的正整数，可用二进制方法进行状态压缩，设计一个数组 dp，对于 dp[i]，若 i 的第 j 个二进制位为 1，说明整数 j 已被选取，dp[i] 则表示该状态下优美的排列数量。   
   
结合动态规划方法，依次遍历 [1, 2^n - 1] 范围内的所有排列情况，对每种情况，若 i 中有 cnt 个比特位为 1，说明当前添加的是第 cnt 个整数。若 i 中选取了整数 j (说明 j 可以为第 cnt 个整数)，且 j 能被 cnt 整除或 cnt 能被 j 整除，则累加统计符合要求的排列数。   
   
最终，dp[2^n - 1] 就是全部整数被选取时的优美排列数，即所求解的答案。   
### （2）代码
```java
class Solution {
    public int countArrangement(int n) {
        int range = 1 << n;//二进制范围[1, 2^n-1]
        int[] dp = new int[range];//dp[i]中，若i的第j个二进制位为1，说明整数j已被选取，dp[i]表示该状态下优美的排列数量
        Arrays.fill(dp, 0);
        dp[0] = 1;//初始值，选取0个数的排列数量为1
        for (int i = 1; i < range; i++) {//动态规划
            int cnt = Integer.bitCount(i);//i中有cnt个比特位为1，说明当前添加的是第cnt个整数
            for (int j = 1; j <= n; j++) {//遍历所有整数
                if (((i >> (j - 1)) & 1) == 1 && (j % cnt == 0 || cnt % j == 0)) {//i中选取了整数j(说明j可以为第cnt个整数)，且j能被cnt整除或cnt能被j整除
                    dp[i] += dp[i ^ (1 << (j - 1))];//统计符合要求的排列数
                }
            }
        }
        return dp[range - 1];//答案为全部整数被选取时的排列数
    }
}
```
### （3）结果
执行用时 ：6 ms，在所有 Java 提交中击败了 96.09% 的用户；    
内存消耗 ：35.4 MB，在所有 Java 提交中击败了 16.45% 的用户。      
# 三、其他
暂无。  
